#!/bin/bash
# zsetup - Run Zen setup from anywhere
#
# Usage: zsetup [OPTIONS]
#   --minimal       Shell, CLI tools, tmux, git, python
#   --standard      Minimal + Neovim (default)
#   --full          Standard + Docker
#   --ml            Full + NVIDIA GPU (Linux only)
#   -i, --interactive   Choose components interactively
#   -v, --verbose       Show detailed output
#   --dry-run           Show what would be installed
#   -h, --help          Show help

# Find Zen directory
find_zen_dir() {
  # Check environment variable first
  if [[ -n "$ZEN_SETUP_DIR" ]] && [[ -d "$ZEN_SETUP_DIR" ]]; then
    echo "$ZEN_SETUP_DIR"
    return 0
  fi

  # Default location
  local default_dir="$HOME/.local/share/zen-setup"
  if [[ -d "$default_dir" ]]; then
    echo "$default_dir"
    return 0
  fi

  # Check if we're in the zen directory
  if [[ -f "./bootstrap.sh" ]] && [[ -d "./roles" ]]; then
    pwd
    return 0
  fi

  return 1
}

ZEN_DIR=$(find_zen_dir)

if [[ -z "$ZEN_DIR" ]]; then
  echo "Error: Zen setup directory not found."
  echo ""
  echo "Please set ZEN_SETUP_DIR or install Zen first:"
  echo "  curl -fsSL https://raw.githubusercontent.com/Ankur-singh/zen-setup/main/install.sh | bash"
  exit 1
fi

exec bash "$ZEN_DIR/bootstrap.sh" "$@"
